{# WebPhomet — Pentest Report Template #}
{# ===================================== #}

# Penetration Test Report

---

## Cover

| Field            | Value                                         |
|------------------|-----------------------------------------------|
| **Target**       | {{ session.target_base_url }}                 |
| **App Type**     | {{ session.app_type or "N/A" }}               |
| **Session ID**   | `{{ session.id }}`                            |
| **Status**       | {{ session.status }}                          |
| **Date**         | {{ metadata.get("date", "N/A") }}             |
| **Tester**       | {{ metadata.get("tester", "WebPhomet Agent") }}|

---

## 1. Executive Summary

This report presents the findings of an automated penetration test conducted
against **{{ session.target_base_url }}** using the WebPhomet orchestration
platform.

**Total findings: {{ findings | length }}**

| Severity | Count |
|----------|-------|
| Critical | {{ findings | selectattr("severity", "equalto", "critical") | list | length }} |
| High     | {{ findings | selectattr("severity", "equalto", "high")     | list | length }} |
| Medium   | {{ findings | selectattr("severity", "equalto", "medium")   | list | length }} |
| Low      | {{ findings | selectattr("severity", "equalto", "low")      | list | length }} |
| Info     | {{ findings | selectattr("severity", "equalto", "info")     | list | length }} |

---

## 2. Scope & Methodology

### 2.1 Scope

{% if session.scope %}
```json
{{ session.scope | tojson(indent=2) }}
```
{% else %}
Scope details were not explicitly defined for this session.
{% endif %}

### 2.2 Targets Discovered

| # | Host | Ports | Technologies |
|---|------|-------|--------------|
{% for target in targets %}
| {{ loop.index }} | {{ target.host }} | {{ target.ports or "—" }} | {{ target.technologies or "—" }} |
{% endfor %}

### 2.3 Tools Used

| # | Tool | Command | Status | Exit Code |
|---|------|---------|--------|-----------|
{% for run in tool_runs %}
| {{ loop.index }} | {{ run.tool_name }} | `{{ run.command[:80] }}` | {{ run.status }} | {{ run.exit_code if run.exit_code is not none else "—" }} |
{% endfor %}

---

## 3. Risk Matrix

| Severity | Impact   | Likelihood | Count |
|----------|----------|------------|-------|
| Critical | Very High| High       | {{ findings | selectattr("severity", "equalto", "critical") | list | length }} |
| High     | High     | Medium–High| {{ findings | selectattr("severity", "equalto", "high")     | list | length }} |
| Medium   | Medium   | Medium     | {{ findings | selectattr("severity", "equalto", "medium")   | list | length }} |
| Low      | Low      | Low–Medium | {{ findings | selectattr("severity", "equalto", "low")      | list | length }} |
| Info     | Info     | N/A        | {{ findings | selectattr("severity", "equalto", "info")     | list | length }} |

---

## 4. Technical Findings

{% for finding in findings %}
### 4.{{ loop.index }} — {{ finding.title }}

| Field          | Value                     |
|----------------|---------------------------|
| **Severity**   | {{ finding.severity }}    |
| **Status**     | {{ finding.status }}      |
| **Type**       | {{ finding.vuln_type }}   |
| **Likelihood** | {{ finding.likelihood or "N/A" }} |

**Description:**

{{ finding.description or "_No description provided._" }}

{% if finding.evidence %}
**Evidence:**

```
{{ finding.evidence }}
```
{% endif %}

{% if finding.poc %}
**Proof of Concept:**

```
{{ finding.poc }}
```
{% endif %}

{% if finding.impact %}
**Impact:** {{ finding.impact }}
{% endif %}

{% if finding.recommendation %}
**Recommendation:** {{ finding.recommendation }}
{% endif %}

{% if finding.references %}
**References:**
{% for key, value in finding.references.items() %}
- {{ key }}: {{ value }}
{% endfor %}
{% endif %}

---

{% endfor %}

## 5. Annexes

### A. Raw Tool Outputs

Artefacts are stored in the session artifacts directory and can be retrieved
via the WebPhomet API using session ID `{{ session.id }}`.

### B. Methodology Notes

This assessment was performed using WebPhomet's autonomous pentesting
pipeline which coordinates security tools through the Model Context Protocol
(MCP). All activities were constrained to the defined scope.

---

*Report generated by WebPhomet v0.1.0*
